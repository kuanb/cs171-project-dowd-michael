<!DOCTYPE html>
<meta charset="utf-8">
<head>
    <link rel="stylesheet" type="text/css" href="css/mycss.css">

    <!-- Add Libraries -->
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script src="http://d3js.org/queue.v1.min.js"></script>
    <script src="http://d3js.org/topojson.v1.min.js"></script>

    <!-- Local Libs & Tools -->
    <script src="packages/simple_statistics.js"></script>
    <script src="js/chloroClass.js"></script>

    <!-- Viz Elements -->
    <script src="js/accessibility.js"></script>
</head>

<body>

<!--Slider has same class as when year is changed similar data actions occur as with continent checkboxes-->
<div>

    <div class="Atype" id = "slider">
        <span id = "min"></span><input id="theSlider" type="range" min=0 max=6 step=1 value=0 oninput="showValue(value)"><span id="max"></span>
        <span>Inundation Level :&nbsp;</span>
        <span id="range">0ft</span>
    </div>
    <div class="Atype" id = "auto" >Auto</div>
    <div class="Atype" id = "transit" >Transit</div>
    <div class ="Atype" id = "walk">Walk</div>

    <div id="map"></div>
</div>

<script>
    var data;
    var access;
    var auto, transit, walk;
    var access_viz;
    queue()
            .defer(d3.json, "data/topotaz2.json")
            .defer(d3.tsv, "data/access_JOBS/autoJobs.tsv")
            .defer(d3.tsv, "data/access_Jobs/transitJobs.tsv")
            .defer(d3.tsv, "data/access_JOBS/walkJobs.tsv")
            .await(ready);

    function ready(error, theTaz, Qauto, Qtransit, Qwalk) {
        data = theTaz;
        auto = Qauto;
        transit = Qtransit;
        walk = Qwalk;
        access = auto;
        current = auto;
        access_viz = new AccessVis(d3.select("#map"))
        access_viz.wrangleData(access, 0);
        access_viz.updateVis()

    }

    function showValue(value){
        access_viz.showValue(value)
    }

    //Acceessibility Click
    d3.select("body").selectAll(".Atype").on("click", function(d){
        that = access_viz;
        if (this.id === "walk") access = walk;
        if (this.id === "auto") access = auto;
        if (this.id === "transit") access = transit;
        that.wrangleData(access,+d3.select("#theSlider").property("value") )
    });

    d3.select(self.frameElement).style("height", access_viz.height + "px");

</script>