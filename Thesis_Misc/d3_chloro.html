<!DOCTYPE html>
<meta charset="utf-8">
<head>

    <!-- Add Libraries -->
    <script src="libs/d3/d3.min.js" charset="utf-8"></script>
    <script src="libs/jquery/jquery-2.1.1.min.js" charset="utf-8"></script>
    <script src="libs/bootstrap/js/bootstrap.min.js" charset="utf-8"></script>
    <script src="http://d3js.org/queue.v1.min.js"></script>
    <script src="http://d3js.org/topojson.v1.min.js"></script>
    <script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
    <script src="packages/simple_statistics.js"></script>

    <!-- My Tools -->
    <script src="js/chloroClass.js"></script>

    <!-- LEAFLET DATA -->
    <script src="data/transitLines.js"></script>
    <script src="data/dta100V.js"></script>

    <!-- Viz Elements -->
    <script src="js/accessibility.js"></script>
    <script src="js/topoMap.js"></script>
    <script src="js/streetMap.js"></script>
    <script src="js/chart.js"></script>
    <script src="js/topoNet.js"></script>
    <script src="js/groupedChart.js"></script>

    <!--<meta name="viewport" content="width=device-width, initial-scale=1.0">-->
    <link rel="stylesheet" type="text/css" href="libs/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" />
    <link rel="stylesheet" type="text/css" href="css/mycss.css">


</head>

<body>

<div class="container">
    <div class="row clearfix">
        <div class="col-md-12 column">
            <div>

                <div class="Btype" id = "slider">
                    <span id = "min"></span><input id="theSlider" type="range" min=0 max=6 step=1 value=0 oninput="showValue(value)"><span id="max"></span>
                    <span>Inundation Level :&nbsp;</span>
                    <span id="range">0ft</span>
                </div>
                <div class="Atype" id = "auto" >Auto</div>
                <div class="Atype" id = "transit" >Transit</div>
                <div class="Atype" id = "walk">Walk</div>
                <div>
                   <label>Layout&nbsp;&nbsp;<select id = "dropDown">
                        <option value="Access">Accessibility</option>
                        <option value="Volume">Volume</option>
                        <option value="Transit">Transit Change</option>
                        <option value="Assets">Inundated Assets</option>
                    </select></label>
                    </div>

            </div>
        </div>
    </div>
    <div class="row clearfix">
        <div class="col-md-6 column">
            <div id="map"></div>
        </div>
        <div class="col-md-6 column">
            <!--Top-->
            <div id="DataSelection">
                <div class="btn-group-horizontal">
                <button type="button" class="btn btn-primary">Demographics</button>
                <button type="button" class="btn btn-primary">Highway</button>
                <button type="button" class="btn btn-primary">Transit</button>
                <button type="button" class="btn btn-primary">Misc.</button>

               </div>
                <div id = "context"></div>
            </div>

            <div>
                <div class="col-md-6 column">
                    <div class = "charts" id = "chart"></div>
                </div>
                <div class="col-md-6 column">
                    <div class = "charts" id = "chart1"></div>
                </div>
            </div>
            <div>
                <div class="col-md-6 column">
                    <div class = "charts" id = "chart2"></div>
                </div>
                <div class="col-md-6 column">
                    <div class = "charts" id = "chart3"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<!--Slider has same class as when year is changed similar data actions occur as with continent checkboxes-->


</body>


<script>
    var t;
    var jobs, hh, pop, tazarea;
    var data;
    var access;
    var current = null;
    var auto, transit, walk, dta;

    queue()
            .defer(d3.json, "data/topotaz2.json")
            .defer(d3.json, "data/assets/jobs.json")
            .defer(d3.json, "data/assets/hh.json")
            .defer(d3.json, "data/assets/pop.json")
            .defer(d3.json, "data/assets/tazarea.json")
            .defer(d3.tsv, "data/access_JOBS/autoJobs.tsv")
            .defer(d3.tsv, "data/access_Jobs/transitJobs.tsv")
            .defer(d3.tsv, "data/access_JOBS/walkJobs.tsv")
            .defer(d3.json, "data/DTA_g100V.json")
            .await(ready);

    function ready(error, theTaz, Qjobs, Qhh, Qpop, Qtazarea, Qauto, Qtransit, Qwalk, Qdta) {
        data = theTaz;
        auto = Qauto;
        transit = Qtransit;
        walk = Qwalk;
        access = auto;
        jobs = Qjobs;
        dta = Qdta;
        hh = Qhh;
        pop = Qpop;
        tazarea = Qtazarea;


        //Old
        //net_viz = new NetVis(d3.select("#map")); //Just TopoJSON

        // Accessibility Visualization
        access_viz = new AccessVis(d3.select("#map"), "Access");
        access_viz.wrangleData(access, 0);
        access_viz.updateVis();

        //Leaflet with Volume TopoJSON Road Network
        //topo_street_viz = new TopoStreetMapVis("map");

        //Public Transit On OFF Difference Maps
//        street_viz = new StreetMapVis("map");

        //Asset Charts 1-4
        asset_viz = new AssetVis(d3.select("#chart"), jobs, "Jobs");
        asset_viz2 = new AssetVis(d3.select("#chart1"), pop,  "Population");
        asset_viz3 = new AssetVis(d3.select("#chart2"), hh, "Households");
        asset_viz4 = new AssetVis(d3.select("#chart3"), tazarea, "Taz Area Meters Sq.");

    }

    $(document).ready(function() {
        $(".btn-primary").click(function(){
            console.log(this)
        });
    });

//    $(document).ready(function() {
//        var current = d3.select("#dropDown").value;
//        $("#dropDown").on("change", function(){
//            d3.select("#"+current).classed(".hide", true);
//            d3.select("#"+this.value).classed(".hide",false);
//
//        });
//    });


    function showValue(value){
        access_viz.showValue(value)
    }

    //Acceessibility Click
    d3.select("body").selectAll(".Atype").on("click", function(d){
        that = access_viz;
        if (this.id === "walk") access = walk;
        if (this.id === "auto") access = auto;
        if (this.id === "transit") access = transit;
        document.getElementById("theSlider").value = "0";
        document.getElementById("range").innerHTML=  "0ft";
        that.wrangleData(access,+d3.select("#theSlider").property("value") )
    });

</script>